import{_ as K,a as Q,b as W}from"./DM3Tqn9U.js";import{_ as X}from"./CebX71QQ.js";import{_ as Y}from"./DgYbWisy.js";import{_ as Z}from"./DVMltJI-.js";import{j as ee,u as te,e as oe,r,k as se,h as ae,c as le,a as i,b as t,l as k,v as ie,f as o,g as _,w as m,m as ne,o as re,T as me}from"#entry";import pe from"./CSxHstX9.js";import ue from"./zCDA6MoO.js";import de from"./DqrUqIlh.js";import ce from"./CUCPziQL.js";import{u as fe}from"./LTkOV7AE.js";import{u as be}from"./CZP_dV7Z.js";import"./Br_va_iO.js";import"./CiUYImg-.js";import"./DU9eW80r.js";import"./BfN_kq1x.js";import"./DOZmIJx8.js";import"./DXDMFhAb.js";import"./DMCytEUc.js";import"./yJelkcis.js";import"./CcGQrQk2.js";import"./DUizPiN4.js";import"./BoT18Mwy.js";import"./CBCNkb8J.js";import"./CxZoyLxt.js";import"./Dp2_RNTJ.js";import"./CR3pEzlc.js";import"./SMq0yiIP.js";import"./4Sk9HVMb.js";import"./COxwCSAn.js";import"./CY8gQTDn.js";import"./Bz-jjpby.js";import"./39KAbCv_.js";import"./C5sN80qK.js";import"./De25nQod.js";import"./BXWK71xQ.js";import"./CIQ9zT1R.js";import"./CIm6bv1W.js";import"./DtiVOhv0.js";import"./D2POmY7n.js";import"./ButSYwWS.js";import"./B6_mwsIV.js";import"./BZMYUYjp.js";const _e={"aria-label":"List of user accounts",class:"space-y-7"},ve={class:"space-y-2"},ge={class:"flex items-center justify-between pb-3 border-b border-gray-200"},he={class:"text-emerald-500 pi pi-spinner animate-spin",style:{"font-size":"1.2rem"}},Ne={class:"space-y-1"},ye={class:"space-x-1.5"},we=["onClick"],Ue=["onClick"],ct={__name:"list",setup(xe){fe({title:"Users - IUGDesign",meta:[{name:"description",content:"My design project application."}]}),ee(()=>x());const b=ae(),{$apiFetch:v}=te(),{s:A,e:g,w:h}=be(),C=oe(),N=r(!1),y=r(!1),w=r(!1),L=r([]),d=r(!1),c=r(!1),U=r({}),s=r({firstName:"",lastName:"",mailingAddress:"",phoneNumber:"",position:"",department:""}),D=r({icon:"pi pi-home"}),M=r([{label:"Users"}]),O=se(()=>c.value?"Edit user":"Create new user"),P=()=>{s.value={firstName:"",lastName:"",mailingAddress:"",phoneNumber:"",position:"",department:""}},S=()=>d.value=!0,j=()=>{d.value=!1,P()},z=()=>c.value=!0,E=()=>{U.value={},c.value=!1},x=async()=>{y.value=!0;try{const a=await v(b.public.user.list);console.log("users list: ",a),L.value=a.data.users}catch({status:a,data:e}){switch(console.log("users list error: ",e,a),a){case 422:Object.values(e.errors).map(n=>g(n[0]));break;default:h(e.message);break}}finally{y.value=!1}},F=async()=>{let a=c.value?b.public.user.edit.replace(":user",U.value.id):b.public.user.store;N.value=!0;try{const e=await v(a,{method:"POST",body:s.value});console.log("user store: ",e),A(e.message),j(),c.value&&E(),x()}catch({status:e,data:n}){switch(console.log("user store error: ",e,n),e){case 422:Object.values(n.errors).map(f=>g(f[0]));break;default:h(n.message);break}}finally{N.value=!1}},B=async a=>{w.value=!0;try{const e=await v(b.public.user.delete.replace(":user",a),{method:"POST"});A(e.message),x()}catch({status:e,data:n}){switch(console.log("user delete error: ",e,n),e){case 422:Object.values(n.errors).map(f=>g(f[0]));break;default:h(n.message);break}}finally{w.value=!1}},I=a=>{s.value.firstName=a.firstName,s.value.lastName=a.lastName,s.value.mailingAddress=a.mailingAddress,s.value.phoneNumber=a.phoneNumber,s.value.position=a.role[0],s.value.department=a.department,console.log(a,s.value),U.value=a,z(),S()};return(a,e)=>{const n=K,f=Q,p=ce,H=de,V=X,u=ue,R=Y,T=W,q=Z,G=pe,$=me;return re(),le("section",_e,[i("div",ve,[i("div",ge,[i("span",null,[k(i("i",he,null,512),[[ie,o(w)]])]),t(n,{onClick:_(S,["prevent"]),label:"Create",icon:"pi pi-plus",pt:{icon:{style:"font-size: 0.7rem"}}})]),i("div",Ne,[e[7]||(e[7]=i("h1",{class:"text-xl font-semibold text-gray-500"},"Users list",-1)),t(f,{home:o(D),model:o(M)},null,8,["home","model"])])]),t(H,{value:o(L),paginator:"",rows:10,rowsPerPageOptions:[20,30,40,50],scrollable:"",loading:o(y),scrollHeight:"400px",virtualScrollerOptions:{itemSize:44},tableStyle:"min-width: 50rem"},{default:m(()=>[t(p,{field:"fullName",header:"Name",style:{width:"30%"}}),t(p,{field:"mailingAddress",header:"Email",style:{width:"15%"}}),t(p,{field:"phoneNumber",header:"Phone Number",style:{width:"15%"}}),t(p,{field:"position",header:"Position",style:{width:"15%"}}),t(p,{field:"department.name",header:"Department",style:{width:"15%"}}),t(p,{header:"Actions",style:{width:"10%"}},{body:m(l=>[i("span",ye,[k(i("i",{onClick:_(J=>I(l.data),["prevent"]),class:"cursor-pointer pi pi-pen-to-square hover:text-emerald-500"},null,8,we),[[$,"Edit"]]),k(i("i",{onClick:_(J=>B(l.data.id),["prevent"]),class:"z-50 cursor-pointer pi pi-trash hover:text-red-500"},null,8,Ue),[[$,"Delete"]])])]),_:1})]),_:1},8,["value","loading"]),t(G,{visible:o(d),"onUpdate:visible":e[6]||(e[6]=l=>ne(d)?d.value=l:null),maximizable:"",modal:"",header:o(O)},{default:m(()=>[i("form",{onSubmit:_(F,["prevent"]),class:"px-3 mt-7 space-y-7 xs:w-96"},[t(u,{variant:"on"},{default:m(()=>[t(V,{id:"firstName",modelValue:o(s).firstName,"onUpdate:modelValue":e[0]||(e[0]=l=>o(s).firstName=l),autocomplete:"off"},null,8,["modelValue"]),e[8]||(e[8]=i("label",{for:"firstName"}," First Name ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(V,{id:"lastName",modelValue:o(s).lastName,"onUpdate:modelValue":e[1]||(e[1]=l=>o(s).lastName=l),autocomplete:"off"},null,8,["modelValue"]),e[9]||(e[9]=i("label",{for:"lastName"}," Last Name ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(V,{id:"mailingAddress",modelValue:o(s).mailingAddress,"onUpdate:modelValue":e[2]||(e[2]=l=>o(s).mailingAddress=l),type:"email",autocomplete:"off"},null,8,["modelValue"]),e[10]||(e[10]=i("label",{for:"mailingAddress"}," Email Address ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(R,{id:"phoneNumber",modelValue:o(s).phoneNumber,"onUpdate:modelValue":e[3]||(e[3]=l=>o(s).phoneNumber=l),mask:"9-99-99-99-99"},null,8,["modelValue"]),e[11]||(e[11]=i("label",{for:"phoneNumber"}," Phone Number ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(T,{modelValue:o(s).position,"onUpdate:modelValue":e[4]||(e[4]=l=>o(s).position=l),options:o(C).authUser.settings.roles,optionLabel:"name",labelId:"position"},null,8,["modelValue","options"]),e[12]||(e[12]=i("label",{for:"position"}," Function ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(T,{modelValue:o(s).department,"onUpdate:modelValue":e[5]||(e[5]=l=>o(s).department=l),options:o(C).authUser.settings.departments,optionLabel:"name",labelId:"department"},null,8,["modelValue","options"]),e[13]||(e[13]=i("label",{for:"department"}," Department ",-1))]),_:1}),t(q,{type:"submit",label:"Create",iconPos:"right",loading:o(N)},null,8,["loading"])],32)]),_:1},8,["visible","header"])])}}};export{ct as default};
