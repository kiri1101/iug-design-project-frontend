import{_ as K,a as Q,b as W,c as X}from"./B7FaAFU0.js";import{_ as Y}from"./C2Q4iZHB.js";import{_ as Z}from"./G40_Fdoc.js";import{_ as ee}from"./Bjzi-0GT.js";import{j as te,u as oe,e as se,r,k as ae,h as le,c as ie,a,b as t,l as k,v as ne,f as o,g as v,w as m,m as re,o as me,T as pe}from"#entry";import ue from"./C_kM5dfH.js";import de from"./CGy5h3sp.js";import ce from"./CcvBuKHO.js";import fe from"./DWPQay7h.js";import{u as be}from"./BCFDp_G3.js";import{u as ve}from"./CFrJbO24.js";import"./CGmKtbvG.js";import"./BgcSbsA3.js";import"./pWF3utpX.js";import"./D0LZ5OLh.js";import"./FRFix3fD.js";import"./C6m3TgAK.js";import"./DZP-w22Q.js";import"./EljBqjgw.js";import"./jsFwD7DF.js";import"./B4DU62h0.js";import"./CgW7-Nmc.js";import"./BU2kb0bE.js";import"./0sFbP2Bq.js";import"./XjkBsr0e.js";import"./C69VbVQL.js";import"./CZqzCbmI.js";import"./BKtgS-B3.js";import"./Ce6Emhl2.js";import"./CA4OP84X.js";import"./Bx5VyNCC.js";import"./DrSoeQDR.js";import"./CBkM_Er_.js";import"./DLHNvk6E.js";import"./Ci_Bge8Z.js";import"./BOxxqukX.js";import"./Ch1LsPA5.js";import"./BzdYrOAP.js";import"./B3Kd881_.js";import"./T7fWn0xy.js";import"./J40zrwK1.js";import"./CQa3mx-M.js";const _e={"aria-label":"List of user accounts",class:"space-y-7"},ge={class:"space-y-2"},he={class:"flex items-center justify-between pb-3 border-b border-gray-200"},Ne={class:"text-emerald-500 pi pi-spinner animate-spin",style:{"font-size":"1.2rem"}},ye={class:"space-y-1"},we={class:"space-x-1.5"},Ue=["onClick"],xe=["onClick"],ft={__name:"list",setup(Ve){be({title:"Users - IUGDesign",meta:[{name:"description",content:"My design project application."}]}),te(()=>x());const b=le(),{$apiFetch:_}=oe(),{s:A,e:g,w:h}=ve(),C=se(),N=r(!1),y=r(!1),w=r(!1),j=r([]),d=r(!1),c=r(!1),U=r({}),s=r({firstName:"",lastName:"",mailingAddress:"",phoneNumber:"",position:"",department:""}),D=r({icon:"pi pi-home"}),M=r([{label:"Users"}]),O=ae(()=>c.value?"Edit user":"Create new user"),P=()=>{s.value={firstName:"",lastName:"",mailingAddress:"",phoneNumber:"",position:"",department:""}},L=()=>d.value=!0,S=()=>{d.value=!1,P()},z=()=>c.value=!0,E=()=>{U.value={},c.value=!1},x=async()=>{y.value=!0;try{const l=await _(b.public.user.list);console.log("users list: ",l),j.value=l.data.users}catch({status:l,data:e}){switch(console.log("users list error: ",e,l),l){case 422:Object.values(e.errors).map(n=>g(n[0]));break;default:h(e.message);break}}finally{y.value=!1}},F=async()=>{let l=c.value?b.public.user.edit.replace(":user",U.value.id):b.public.user.store;N.value=!0;try{const e=await _(l,{method:"POST",body:s.value});console.log("user store: ",e),A(e.message),S(),c.value&&E(),x()}catch({status:e,data:n}){switch(console.log("user store error: ",e,n),e){case 422:Object.values(n.errors).map(f=>g(f[0]));break;default:h(n.message);break}}finally{N.value=!1}},B=async l=>{w.value=!0;try{const e=await _(b.public.user.delete.replace(":user",l),{method:"POST"});A(e.message),x()}catch({status:e,data:n}){switch(console.log("user delete error: ",e,n),e){case 422:Object.values(n.errors).map(f=>g(f[0]));break;default:h(n.message);break}}finally{w.value=!1}},H=l=>{s.value.firstName=l.firstName,s.value.lastName=l.lastName,s.value.mailingAddress=l.mailingAddress,s.value.phoneNumber=l.phoneNumber,s.value.position=l.role[0],s.value.department=l.department,console.log(l,s.value),U.value=l,z(),L()};return(l,e)=>{const n=K,f=Q,p=fe,I=ce,V=Y,u=de,R=Z,T=X,q=ee,G=ue,$=pe;return me(),ie("section",_e,[a("div",ge,[a("div",he,[a("span",null,[k(a("i",Ne,null,512),[[ne,o(w)]])]),t(n,{onClick:v(L,["prevent"]),label:"Create",icon:"pi pi-plus",pt:{icon:{style:"font-size: 0.7rem"}}})]),a("div",ye,[e[7]||(e[7]=a("h1",{class:"text-xl font-semibold text-gray-500"},"Users list",-1)),t(f,{home:o(D),model:o(M)},null,8,["home","model"])])]),t(I,{value:o(j),paginator:"",rows:10,rowsPerPageOptions:[20,30,40,50],scrollable:"",loading:o(y),scrollHeight:"400px",virtualScrollerOptions:{itemSize:44},tableStyle:"min-width: 50rem"},{empty:m(()=>[...e[8]||(e[8]=[a("div",{class:"flex justify-center py-5"},[a("span",null,[a("img",{src:W,class:"object-center object-cover w-24"}),a("h5",{class:"text-sm text-center"},"No data")])],-1)])]),default:m(()=>[t(p,{field:"fullName",header:"Name",style:{width:"30%"}}),t(p,{field:"mailingAddress",header:"Email",style:{width:"15%"}}),t(p,{field:"phoneNumber",header:"Phone Number",style:{width:"15%"}}),t(p,{field:"position",header:"Position",style:{width:"15%"}}),t(p,{field:"department.name",header:"Department",style:{width:"15%"}}),t(p,{header:"Actions",style:{width:"10%"}},{body:m(i=>[a("span",we,[k(a("i",{onClick:v(J=>H(i.data),["prevent"]),class:"cursor-pointer pi pi-pen-to-square hover:text-emerald-500"},null,8,Ue),[[$,"Edit"]]),k(a("i",{onClick:v(J=>B(i.data.id),["prevent"]),class:"z-50 cursor-pointer pi pi-trash hover:text-red-500"},null,8,xe),[[$,"Delete"]])])]),_:1})]),_:1},8,["value","loading"]),t(G,{visible:o(d),"onUpdate:visible":e[6]||(e[6]=i=>re(d)?d.value=i:null),maximizable:"",modal:"",header:o(O),onHide:S},{default:m(()=>[a("form",{onSubmit:v(F,["prevent"]),class:"px-3 mt-7 space-y-7 xs:w-96"},[t(u,{variant:"on"},{default:m(()=>[t(V,{id:"firstName",modelValue:o(s).firstName,"onUpdate:modelValue":e[0]||(e[0]=i=>o(s).firstName=i),autocomplete:"off"},null,8,["modelValue"]),e[9]||(e[9]=a("label",{for:"firstName"}," First Name ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(V,{id:"lastName",modelValue:o(s).lastName,"onUpdate:modelValue":e[1]||(e[1]=i=>o(s).lastName=i),autocomplete:"off"},null,8,["modelValue"]),e[10]||(e[10]=a("label",{for:"lastName"}," Last Name ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(V,{id:"mailingAddress",modelValue:o(s).mailingAddress,"onUpdate:modelValue":e[2]||(e[2]=i=>o(s).mailingAddress=i),type:"email",autocomplete:"off"},null,8,["modelValue"]),e[11]||(e[11]=a("label",{for:"mailingAddress"}," Email Address ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(R,{id:"phoneNumber",modelValue:o(s).phoneNumber,"onUpdate:modelValue":e[3]||(e[3]=i=>o(s).phoneNumber=i),mask:"9-99-99-99-99"},null,8,["modelValue"]),e[12]||(e[12]=a("label",{for:"phoneNumber"}," Phone Number ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(T,{modelValue:o(s).position,"onUpdate:modelValue":e[4]||(e[4]=i=>o(s).position=i),options:o(C).authUser.settings.roles,optionLabel:"name",labelId:"position"},null,8,["modelValue","options"]),e[13]||(e[13]=a("label",{for:"position"}," Function ",-1))]),_:1}),t(u,{variant:"on"},{default:m(()=>[t(T,{modelValue:o(s).department,"onUpdate:modelValue":e[5]||(e[5]=i=>o(s).department=i),options:o(C).authUser.settings.departments,optionLabel:"name",labelId:"department"},null,8,["modelValue","options"]),e[14]||(e[14]=a("label",{for:"department"}," Department ",-1))]),_:1}),t(q,{type:"submit",label:"Create",iconPos:"right",loading:o(N)},null,8,["loading"])],32)]),_:1},8,["visible","header"])])}}};export{ft as default};
